<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./styles.css">
    <title>Ticket Booking</title>
</head>
<body>
    <div class="card">
        <h1>Welcome !!!!</h1>
        <p>Total Seats:  <span id="total-seats">100</span></p>
        <p>Seats Available: <span id="seats-available">100</span></p>
        <p>Total Tickets Sold: <span id="tickets-sold">0</span></p>
        <p id="sold-out-message" style="color:red; display:none;">Tickets are sold out!</p>
    </div>
    <div class="inforBox">
        <div>
            <label for="name">Name</label>
            <input type="text" id="name" required>
        </div>
        <div>
            <label for="email">Email</label>
            <input type="email" id="email" required>
        </div>
        <div>
            <label for="tickets">Tickets</label>
            <input type="number" id="tickets" min="1" max="100" required>
        </div>
        <div>
            <button type="submit" id="submit-btn">Buy Now</button>
        </div>
    </div>
    <div class="filterUser">
        <div>
            <label for="userEmail">Filter by email</label>
            <input type="email" id="userEmail">
        </div>
        <div>
            <button type="submit" id="search-btn">Search</button>
        </div>
        <p id="search-result"></p>
    </div>

    <script>
        let submitBtn = document.getElementById('submit-btn');
        let searchBtn = document.getElementById('search-btn');
        const inforBox = document.querySelector(".inforBox");
        let Booking = [];

        function handleClick() {
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            let tickets = parseInt(document.getElementById('tickets').value);

            let seatsAvailable = parseInt(document.getElementById("seats-available").textContent);
            let ticketsSold = parseInt(document.getElementById("tickets-sold").textContent);

            if (tickets > seatsAvailable) {
                alert("Not enough seats available!");
                return;
            }

            seatsAvailable -= tickets;
            ticketsSold += tickets;

            // Store booking information

            Booking.push({ name, email, tickets });

            // Update the UI

            document.getElementById("seats-available").textContent = seatsAvailable;
            document.getElementById("tickets-sold").textContent = ticketsSold;

            // Check if tickets are sold out
            
            if (seatsAvailable === 0) {
                document.getElementById('sold-out-message').style.display = 'block';
                document.querySelector('.inforBox').style.display='none';
            }

            console.log(Booking);
        }

        function handleSearch() {
            const userEmail = document.getElementById('userEmail').value;
            const userBooking = Booking.filter(b => b.email === userEmail);

            const result = userBooking.length > 0 
                ? `Name: ${userBooking[0].name}, Tickets Booked: ${userBooking[0].tickets}` 
                : 'No booking found for this email';

            document.getElementById('search-result').textContent = result;
        }

        submitBtn.addEventListener("click", handleClick);
        searchBtn.addEventListener("click", handleSearch);
    </script>
</body>
</html>
